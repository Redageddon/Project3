@model API.DataModels.Food.RecipeModel

@{
    ViewData["Title"] = "Create Recipe";
    bool isUserLoggedIn = ViewBag.IsUserLoggedIn is bool b && b;
}

<h2 class="mb-4">Create Recipe</h2>
<hr />

<div class="container mt-4">
    @if (!isUserLoggedIn)
    {
        @* Show only the login-required modal (no form) *@
        @await Html.PartialAsync("_LoginRequiredModal")
    }
    else
    {
        @* Show the create form partial *@
        @await Html.PartialAsync("_RecipeCreateForm", Model)
    }
</div>

@section Scripts {
    @if (!isUserLoggedIn)
    {
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                var modalElement = document.getElementById('loginRequiredModal');
                if (!modalElement) return;

                // Requires Bootstrap JS loaded in your _Layout
                if (window.bootstrap && bootstrap.Modal) {
                    var loginModal = new bootstrap.Modal(modalElement);
                    loginModal.show();
                } else {
                    console.warn("Bootstrap Modal is not available. Make sure bootstrap.bundle.js is loaded.");
                }
            });
        </script>
    }
    else
    {
        <script src="~/js/recipe-create.js"></script>
        <script src="~/js/recipe-validation.js"></script>
    }
}
